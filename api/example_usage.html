<html lang="en">
<head>
<title>MDBM</title>
<link rel="stylesheet" href="style.css" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head>
<body>
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">"Using Core-Tech MDBM Handle Pool in your application" </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Properties wishing to use mdbm in multi-threaded applications must make sure each thread uses a unique handle to carry out db operations.</p>
<p>There are two changes that are required to use this library:</p>
<p>1] Create an mdbm handle pool by duplicating your original mdbm handle</p>
<div class="fragment"><div class="line"><span class="comment">// open mdbm file</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> ((db = <a class="code" href="group__FileManagementGroup.html#ga5152a643c7749ba7074519f066eba6e0" title="Creates and/or opens a database.">mdbm_open</a>(fn, flags, 0, 0, 0)) == NULL)</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">// create the mdbm handle pool</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> ((pool = <a class="code" href="mdbm__handle__pool_8h.html#a489ddf10948e8d77e6949a326409b007" title="Create a pool of mdbm handles.">mdbm_pool_create_pool</a>(db, pool_size, NULL)) == NULL) {</div>
<div class="line">  <a class="code" href="group__FileManagementGroup.html#ga9b9521b5a929a7140023e7cd447fa812" title="Closes the database.">mdbm_close</a>(db);</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>2] Obtain a unique handle in your thread for your db operation</p>
<div class="fragment"><div class="line"><span class="comment">// get mdbm handle from the pool</span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> ((dbh = <a class="code" href="mdbm__handle__pool_8h.html#a9507198b363621060ee100fd6f3689a1" title="Acquire an MDBM handle for database operations.">mdbm_pool_acquire_handle</a>(pool, NULL)) == NULL)</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line"><span class="comment">// lock the mdbm handle </span></div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (<a class="code" href="group__LockingGroup.html#ga77f4f19c6c754be1064147a23791486e" title="Locks the database for exclusive access by the caller.">mdbm_lock</a>(dbh) != 1) {</div>
<div class="line">  <a class="code" href="mdbm__handle__pool_8h.html#a8f0088eecf5ab4d17e25dc847355afcc" title="Release MDBM handle back to the pool.">mdbm_pool_release_handle</a>(pool, dbh, NULL);</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// carry out your mdbm operations ...</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// unlock and return the handle to the pool</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="group__LockingGroup.html#ga55d91340c346e3910edeffe990cc199d" title="Unlocks the database, releasing exclusive or shared access by the caller.">mdbm_unlock</a>(dbh);</div>
<div class="line"><a class="code" href="mdbm__handle__pool_8h.html#a8f0088eecf5ab4d17e25dc847355afcc" title="Release MDBM handle back to the pool.">mdbm_pool_release_handle</a>(pool, dbh, NULL);</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- doc footer -->
</body>
</html>
